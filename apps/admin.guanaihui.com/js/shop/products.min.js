function ProductsController(){Controller.call(this),this.instanceMethodizeTable(),this.instanceSwitch(),this.instanceDialog(),this.bind(),this.backCompanyList()}ProductsController.prototype.instanceSwitch=function(){var a=this;require([this.bootstrapStaticPrefix+"/plugins/bootstrap-switch/dist/js/bootstrap-switch.min.js"],function(){var b=$(".data-panel .assistant .filter-bar input[type='checkbox']");b.bootstrapSwitch({onText:"是",offText:"否",size:"small"}),b.on("switchChange.bootstrapSwitch",function(b,c){a.redirect(c)})})},ProductsController.prototype.redirect=function(a){require([this.utilStaticPrefix+"/url.min.js"],function(){Url.updateSearchParam("online",a),window.location.reload()})},ProductsController.prototype.instanceDialog=function(){var a=this;$(".dialog-handle").click(function(){var b=$(this).attr("data-dialog-id"),c="";$(this).hasClass("add")?c=a.apiUrl.shop.products.add:$(this).hasClass("edit")&&(c=a.apiUrl.shop.products.edit),a.dialog({id:b,url:$(this).attr("data-href"),dimension:"lg"}),$("#"+b).on("loaded.bs.modal",function(d){$("#"+b+" form").attr("action",c),require([a.appStaticPrefix+"/shop/product.min.js"],function(){new ProductController({productPanel:$("#"+b),parentClass:a})})})})},ProductsController.prototype.bind=function(){var a=this;$(".data-panel .assistant .tools .remove").click(function(){a.remove($(".data-panel table input[name='methodize-table-checked-set']").val(),$(".assistant .searcher input[name='companyId']").val())}),$(".data-panel .assistant .tools .release").click(function(){a.release($(".data-panel table input[name='methodize-table-checked-set']").val())}),$(".data-panel .assistant .tools .offline").click(function(){a.offline($(".data-panel table input[name='methodize-table-checked-set']").val())}),$(".data-panel table tbody tr").each(function(){var b=$(this).attr("data-id"),c=$(".assistant .searcher input[name='companyId']").val();$(this).find(".offline").click(function(){a.offline(b)}),$(this).find(".remove").click(function(){a.remove(b,c)}),$(this).find(".release").click(function(){a.release(b)})})},ProductsController.prototype.remove=function(a,b){var c=this;return a?void c.confirm({content:"您确定要删除选中的服务吗？",confirmInterface:function(){c.request(c.apiUrl.shop.products["delete"],{id:a,companyId:b,hasChecked:!1},{process:function(d){d.result||c.tips("删除服务成功！",2,function(){window.location.reload()}),d.result&&"1001"===d.result.toString()&&c.confirm({content:"该服务属于营销推荐服务，如果下线会对展示造成影响，您确认要删除吗?",confirmInterface:function(){c.request(c.apiUrl.shop.products["delete"],{id:a,companyId:b,hasChecked:!0},{process:function(){c.tips("删除服务成功！",2,function(){window.location.reload()})}})}})}})}}):(c.tips("请先选择服务！",2),!1)},ProductsController.prototype.release=function(a){if(!a)return this.tips("请先选择服务！",2),!1;var b=this;this.request(this.apiUrl.shop.products.release,{id:a},{process:function(){b.tips("上线服务成功！",2,function(){window.location.reload()})}})},ProductsController.prototype.offline=function(a){if(!a)return this.tips("请先选择服务！",2),!1;var b=this;b.request(b.apiUrl.shop.products.offline,{id:a,hasChecked:!1},{process:function(c){c.result||b.tips("下线服务成功！",2,function(){window.location.reload()}),c.result&&"1001"===c.result.toString()&&b.confirm({content:"该服务属于营销推荐机构/服务，如果下线会对展示造成影响，您确认要下线吗?",confirmInterface:function(){b.request(b.apiUrl.shop.products.offline,{id:a,hasChecked:!0},{process:function(){b.tips("下线服务成功！",2,function(){window.location.reload()})}})}})}})},$(document).ready(function(){new ProductsController});