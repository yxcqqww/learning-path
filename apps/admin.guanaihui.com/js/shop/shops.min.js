function ShopsController(){Controller.call(this),this.memoryCategory(),this.instanceDialog(),$(".data-panel table thead .handle").size()>0&&this.instanceMethodizeTable(),this.bind(),this.backCompanyList(),this.save()}ShopsController.prototype.memoryCategory=function(){$.cookie(this.cookieKeyConf.shop.company.category,window.location.href,{expires:this.cookieExpires,path:"/",domain:this.cookieDomain})},ShopsController.prototype.instanceDialog=function(){var a=this;$(".dialog-handle").click(function(){var b=$(this).attr("data-dialog-id"),c=this;a.dialog({id:b,url:$(this).attr("data-href"),dimension:"lg"}),$("#modal-brand").on("loaded.bs.modal",function(d){var e="";$(c).hasClass("add")?e=a.apiUrl.shop.brand.add:$(c).hasClass("brand")&&(e=a.apiUrl.shop.brand.edit),$("#"+b+" form").attr("action",e),require([a.appStaticPrefix+"/shop/brand.min.js"],function(){new BrandController({brandPanel:$("#"+b),parentClass:a})})})})},ShopsController.prototype.bind=function(){var a=this;$(".data-panel .assistant .tools .offline").click(function(){a.offline($(".data-panel table input[name='methodize-table-checked-set']").val())}),$(".data-panel table tbody tr").each(function(){var b=$(this).attr("data-id");$(this).find(".offline").click(function(){a.offline(b)}),$(this).find(".transfer").click(function(){a.transfer(b)})})},ShopsController.prototype.offline=function(a){if(!a)return this.tips("请先选择机构！",2),!1;var b=this;b.confirm({content:"您确定要下线选中的机构吗？",confirmInterface:function(){b.request(b.apiUrl.shop.offline,{id:a,hasChecked:!1},{process:function(c){c.result||b.tips("下线机构成功！",2,function(){window.location.reload()}),c.result&&"1001"===c.result.toString()&&b.confirm({content:"该机构属于营销推荐机构，如果下线会对展示造成影响，您确认要下线吗?",confirmInterface:function(){b.request(b.apiUrl.shop.offline,{id:a,hasChecked:!0},{process:function(){b.tips("下线机构成功！",2,function(){window.location.reload()})}})}})},onExceptionInterface:function(a){}})}})},ShopsController.prototype.transfer=function(a){var b=this;return a?void this.confirm({content:"您确定要将选中的门店转为待上线状态吗？",confirmInterface:function(){b.request(b.apiUrl.shop.transfer,{id:a},{process:function(){b.tips("机构转待上线成功！",2,function(){window.location.reload()})}})}}):(b.tips("请先选择机构！",2),!1)},ShopsController.prototype.save=function(){var a=this;require([a.utilStaticPrefix+"/jquery.asyncsubmit.min.js"],function(){$(".assistant").find("form").asyncsubmit({utilStaticPrefix:a.utilStaticPrefix,dataType:a.apiDataType,data:function(){for(var a={},b=0;b<$("select[name='primary'] option").length;b++)if($("select[name='primary'] option").eq(b).prop("selected")){queryCIdOne=$("select[name='primary'] option").eq(b).val(),a.queryCIdOne=queryCIdOne;for(var c=0;c<$("select[name='secondary'] option").length;c++)$("select[name='secondary'] option").eq(c).prop("selected")&&(queryCIdTwo=$("select[name='secondary'] option").eq(c).val(),a.queryCIdTwo=queryCIdTwo)}return a},onSavingInterface:function(){a.tips("正在进行处理，请稍等...")},onErrorInterface:function(){a.tips("请求失败，请检查您的接口！",2)},onSuccessInterface:function(b){a.tips("品牌信息保存成功！",2,function(){window.location.reload()})},onExceptionInterface:function(b){a.tips('<span class="text-danger">'+b+"</span>",5)}})})},ShopsController.prototype.initSelectOptions=function(){},$(document).ready(function(){new ShopsController});