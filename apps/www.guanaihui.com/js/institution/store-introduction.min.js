function introduction(){Controller.call(this),this.calculateHeight(),this.servicesCategory(),this.pageChangeListener(),this.chooseAreaListener(),this.storeClickListener(),this.cliclkMap(),this.loadStoreAndService({companyId:$("#companyId").val(),shopId:$("#shopId").val()}),this.ajaxSet()}introduction.prototype.ajaxSet=function(){$.ajaxSetup({cache:!1}),$(".topper-service").load("/personal/toper/count",function(a){})},introduction.prototype.calculateHeight=function(){var a=$(".store-list").outerHeight()+40,b=$(".service-item").outerHeight(),c=a>b?a:b;c=c>327?327:c,$(".store-service").height(c),$(".service-list").height("auto")},introduction.prototype.storeAndService=function(){var a=this;require([a.utilStaticPrefix+"/jquery.slide.min.js"],function(){$(".service-item").slide({autoPlay:!1,titCell:".pagination ul li",effect:"leftLoop",interTime:4e3,vis:1}),a.calculateHeight()})},introduction.prototype.chooseAreaListener=function(){var a=this;$(".select-area").change(function(){var b=$(this),c=b.find("option:selected").attr("value"),d={areaId:c,pageIndex:1,companyId:$("#companyId").val(),shopId:$("#shopId").val()};a.loadStoreAndService(d)})},introduction.prototype.pageChangeListener=function(){var a=this;$(".store-list .page .item a").click(function(){var b=$(this),c=$(".select-area").find("option:selected").attr("value"),d=b.attr("data-index"),e=$("#companyId").val(),f={areaId:c,pageIndex:d,companyId:e,shopId:$("#shopId").val()};a.loadStoreAndService(f)})},introduction.prototype.loadStoreAndService=function(a){var b=this,a=a||{};a.isPrev="prev"===$(".store-service").attr("data-flag"),$(".store-service").load("/company/shop/list/non",a,function(){b.storeAndService(),b.storeClickListener(),b.pageChangeListener();var a={};if($(".store-item").length>0){var c=$(".store-item.active");a.name=c.attr("data-name"),a.address=c.attr("data-address"),a.longitude=c.attr("data-longitude"),a.latitude=c.attr("data-latitude"),a.busTips=c.attr("data-busTips"),a.subwayTips=c.attr("data-subwayTips"),a.parkingDetail=c.attr("data-parkingDetail")}b.createMap(a),console.log("Load was performed.")})},introduction.prototype.storeClickListener=function(){var a=this;$("body").off("click",".store-item:not(.active)").on("click",".store-item:not(.active)",function(){var b=$(this),c=b.attr("data-id");b.addClass("active").siblings(".store-item").removeClass("active");var d={shopId:c,companyId:$("#companyId").val()},e={name:b.attr("data-name"),address:b.attr("data-address"),longitude:b.attr("data-longitude"),latitude:b.attr("data-latitude"),busTips:b.attr("data-busTips"),subwayTips:b.attr("data-subwayTips"),parkingDetail:b.attr("data-parkingDetail")};a.createMap(e),$(".service-list").load("/company/prod/data",d)})},introduction.prototype.cliclkMap=function(){var a=this;$(".special-service").on("click",".store-item dt p i",function(){var b=$(this);$("#myModal").on("shown.bs.modal",function(c){var d=b.closest(".store-item");console.log(d);var e={name:d.attr("data-name"),address:d.attr("data-address"),longitude:d.attr("data-longitude"),latitude:d.attr("data-latitude"),busTips:d.attr("data-busTips"),subwayTips:d.attr("data-subwayTips"),parkingDetail:d.attr("data-parkingDetail")};a.createMap(e)}),$("#myModal").modal()})},introduction.prototype.createMap=function(a){var b=this;point=new BMap.Point(a.longitude,a.latitude),map=new BMap.Map("baiduMapContainer"),map.centerAndZoom(point,15),marker=new BMap.Marker(point),map.addOverlay(marker),marker.setAnimation(BMAP_ANIMATION_BOUNCE);var c=new BMap.InfoWindow("        <dl>            <dt>机构：</dt>            <dd>"+a.name+"</dd>            </dl>            <dl>                <dt>地址：</dt>                <dd>"+a.address+"</dd>            </dl>            <dl>                <dt><img src ="+b.staticDomain+"/apps/www.guanaihui.com/css/images/icon-park.jpg></dt>                <dd>"+a.parkingDetail+"</dd>            </dl>            <dl>                <dt><img src ="+b.staticDomain+"/apps/www.guanaihui.com/css/images/icon-metro.jpg></dt>                <dd>"+a.subwayTips+"</dd>            </dl>             <dl>                <dt><img src ="+b.staticDomain+"/apps/www.guanaihui.com/css/images/icon-bus.jpg></dt>                <dd>"+a.busTips+"</dd>            </dl>            ",{padding:10,width:320});marker.addEventListener("click",function(){this.openInfoWindow(c)}),map.addControl(new BMap.MapTypeControl),map.enableScrollWheelZoom(!1),map.addControl(new BMap.NavigationControl),map.addControl(new BMap.ScaleControl),map.addControl(new BMap.OverviewMapControl),map.addControl(new BMap.MapTypeControl),map.panTo(point)},$(document).ready(function(){new introduction});