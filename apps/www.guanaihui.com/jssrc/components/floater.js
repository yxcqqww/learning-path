/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：www.guanaihui.com
 2. 页面名称：components - > floater(页面组件 -> 页面右边浮动条)
 3. 作者：赵华刚(zhaohuagang@guanaihui.com)
 4. 备注：
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
function Floater() {
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    绘制dom节点
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.draw() ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
绘制dom节点
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
Floater.prototype.draw = function() {
    var $backTop = $(document.createElement("A")).attr("href", "javascript:void(0);").addClass("back-top").append("<i class=\"icon-backtop\"></i>").append("<span>顶部</span>") ;
    $backTop.click(function() {
        $("html,body").animate({
            scrollTop : "0px"
        }, 500) ;
    }) ;
    var $consultation = $(document.createElement("A")).attr("href", "javascript:void(0);").addClass("consultation").append("<i class=\"icon-24 icon-24-consutation\"></i>").append("<span>在线咨询</span>") ;
    $consultation.click(function(){
        var top = parseInt(($(window).height() - 600) /2, 10) ;
        var left = parseInt(($(window).width() - 800) /2, 10) ;
        window.open ("http://p.qiao.baidu.com/im/index?siteid=7075072&ucid=7601540&lastsubid=1338854&from=%E4%B8%8A%E6%B5%B7%E5%BE%90%E6%B1%87&bid=527d747ea7881a593c2185cf&chattype=1&groupid=&groupname=&subid=&subname=&ref=http%3A%2F%2Fwww.360guanai.com%2F", "consultation", "height=600,width=800, top=" + top +", left=" + left + ",toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no") ;
    }) ;
    $(document.body).append($(document.createElement("DIV")).addClass("floater").append($backTop).append($consultation)) ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    绘制好后马上根据滚动条位置决定回到顶部按钮是否显示
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.freeze() ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    事件绑定
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.bind() ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
回到顶部按钮的显示隐藏定格
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
Floater.prototype.freeze = function() {
    if ($(window).scrollTop() >= 100) {
        $(".floater .back-top").slideDown(200) ; 
        $(".floater .consultation").removeClass("single") ;
    } 
    else {
        $(".floater .back-top").slideUp(200) ;
        $(".floater .consultation").addClass("single") ;   
    }
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
事件绑定
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
Floater.prototype.bind = function() {
    var classSelf = this ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    窗口滚动或者重设大小的时候捕捉回到顶部按钮显示状态
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    $(window).on("scroll resize", function() {                
        classSelf.freeze() ;
    }) ;    
} ;