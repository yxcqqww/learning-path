/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：www.guanaihui.com
 2. 页面名称：list(搜索结果页面)
 3. 作者：赵华刚(zhaohuagang@guanaihui.com)
 4. 备注：
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
function ListController() {
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
     继承于Controller基类
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    Controller.call(this) ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    页面顶部全部服务分类下拉
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.servicesCategory() ;    
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    显示模式切换到指定风格
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.switchDisplayMode($(".console .display-mode-handle a.on").attr("data-mode")) ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    控制台显示模式句柄事件绑定
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.addListenerToDisplayModeHandle() ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    其他热门机构的滑动
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.initSlider() ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
显示模式切换
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
ListController.prototype.switchDisplayMode = function(mode) {
    $(".data-panel").removeClass("list").removeClass("waterfall").addClass(mode) ;
    $(".console .display-mode-handle a").each(function(){
        if($(this).attr("data-mode") === mode) $(this).addClass("on") ;
        else $(this).removeClass("on") ;
    }) ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
控制台显示模式句柄事件绑定，注意切换后要触发一下window的scroll事件，用来触动lazyload
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
ListController.prototype.addListenerToDisplayModeHandle = function() {
    var classSelf = this ;
    $(".console .display-mode-handle a").click(function(){
        classSelf.switchDisplayMode($(this).attr("data-mode")) ;
        $(window).trigger("scroll") ;
    }) ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
其他热门机构的滑动
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
ListController.prototype.initSlider = function() {
    require([this.utilStaticPrefix + "/jquery.slide.min.js"], function(){
        $(".other-institutions").slide({
            autoPlay : true ,
            titCell : ".header-pagination ul li" ,
            effect : "leftLoop" ,
            interTime : 4000 ,
            vis : 1            
        }) ;
    }) ;   
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 类的初始化
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
$(document).ready(function () {
    new ListController;
});