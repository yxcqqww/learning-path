!function(t){t.fn.multiselect2tag=function(e){var a=t.extend({},t.fn.multiselect2tag.defaults,e);return this.each(function(){t.fn.multiselect2tag.appendResultContainer(this),t.fn.multiselect2tag.init(this,t(this).next(".multiselect2tag-result-container"),a),t(this).change(function(){return t.fn.multiselect2tag.testRepeat(t(this).val(),t(this).next(".multiselect2tag-result-container"),a)?!1:(t.fn.multiselect2tag.addTag(t(this).find("option:selected").text(),t(this).val(),t(this).next(".multiselect2tag-result-container"),a),t.fn.multiselect2tag.total(t(this).next(".multiselect2tag-result-container"),a),a.selectChangeInterface&&a.selectChangeInterface(),void t(this).val(a.emptyValue))})})},t.fn.multiselect2tag.init=function(e,a,n){var i=t(n.dataSaveInto).val();if(i){var l=i.split(n.separator),s={};t(e).find("option").each(function(){t(this).attr("value")!==n.emptyValue&&(s[t(this).attr("value").toString()]=t(this).text())}),t.each(l,function(){t.fn.multiselect2tag.addTag(s[this],this,a,n)})}},t.fn.multiselect2tag.appendResultContainer=function(e){t(e).next(".multiselect2tag-result-container").size()>0||t(e).after(t(document.createElement("DIV")).addClass("multiselect2tag-result-container"))},t.fn.multiselect2tag.testRepeat=function(e,a,n){if(e===n.emptyValue)return!0;var i=new Array;return t(a).find(".item").each(function(){i.push(t(this).attr("data-id").toString())}),-1!=t.inArray(e.toString(),i)?!0:!1},t.fn.multiselect2tag.addTag=function(e,a,n,i){var l=t(document.createElement("A")).addClass("item").attr("href","javascript:void(0);").attr("data-id",a),s=t(document.createElement("SPAN")).addClass("description").text(e),c=t(document.createElement("SPAN")).addClass("close").append('<i class="iconfont icon-shanchu"></i>');t(c).click(function(){t(this).parent().remove(),t.fn.multiselect2tag.total(n,i),i.tagRemoveInterface&&i.tagRemoveInterface()}),t(l).append(s).append(c),s=null,c=null,t(n).append(l),l=null},t.fn.multiselect2tag.total=function(e,a){var n=new Array;t(e).find(".item").each(function(){n.push(t(this).attr("data-id").toString())}),t(a.dataSaveInto).val(n.join(a.separator))},t.fn.multiselect2tag.defaults={separator:",",dataSaveInto:null,emptyValue:"",selectChangeInterface:null,tagRemoveInterface:null}}(jQuery);