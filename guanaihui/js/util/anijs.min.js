!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("AniJS requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n=function(t){var n="data-anijs",r="default",i="$",o="if",a="on",l="do",s="to",v="(\\s+|^)",c="(\\s+|$)",u="animationend",f="transitionend",d="target";t={rootDOMTravelScope:{},eventProviderCollection:{},init:function(){p._helperCollection={};var e=p._createDefaultHelper();t.registerHelper(r,e),p._helperDefaultIndex=r,t.rootDOMTravelScope=document,t.Parser=p.Parser,p._animationEndEvent=p._animationEndPrefix(),p._classNamesWhenAnim=""},setDOMRootTravelScope:function(e){var n;try{"document"===e?n=document:(n=document.querySelector(e),n||(n=document))}catch(r){n=document}t.rootDOMTravelScope=n},run:function(){var e=[],r={};t.purgeAll(),t.eventProviderCollection={},e=p._findAniJSNodeCollection(t.rootDOMTravelScope);var i,o=e.length,a=0;for(a;o>a;a++)i=e[a],r=p._getParsedAniJSSentenceCollection(i.getAttribute(n)),p._setupElementAnim(i,r);var l=t.getEventProvider("AniJSEventProvider");l&&l.dispatchEvent("onRunFinished")},createAnimation:function(e,t){var n=t||"";p._setupElementAnim(n,e)},getHelper:function(e){var t=p._helperCollection;return t[e]||t[r]},registerHelper:function(e,t){p._helperCollection[e]=t},purge:function(e){if(e&&""!==e&&" "!==e){var n=document.querySelectorAll(e),r=n.length,i=0;for(i;r>i;i++)t.EventSystem.purgeEventTarget(n[i])}},purgeAll:function(){t.EventSystem.purgeAll()},purgeEventTarget:function(e){t.EventSystem.purgeEventTarget(e)},setClassNamesWhenAnim:function(e){p._classNamesWhenAnim=" "+e},createEventProvider:function(){return t.EventSystem.createEventTarget()},registerEventProvider:function(e){var n=t.eventProviderCollection;return e.id&&e.value&&t.EventSystem.isEventTarget(e.value)?(n[e.id]=e.value,1):""},getEventProvider:function(e){return t.eventProviderCollection[e]}};var p={};return p._createDefaultHelper=function(){var e={removeAnim:function(e,t){e.target&&t.nodeHelper.removeClass(e.target,t.behavior)},holdAnimClass:function(){}};return e},p._createParser=function(){return new Parser},p._setupElementAnim=function(e,t){var n,r=t.length,i=0;for(i;r>i;i++)n=t[i],p._setupElementSentenceAnim(e,n)},p._setupElementSentenceAnim=function(e,n){var r=p._eventHelper(n),i=p._eventTargetHelper(e,n);if(""!==r){var o,a=i.length,l=0;for(l;a>l;l++)if(o=i[l],t.EventSystem.isEventTarget(o)){var s=function(r){var i=p._behaviorTargetHelper(e,n,r),o=p._behaviorHelper(n),a=p._beforeHelper(e,n),l=p._afterHelper(e,n);""!==p._classNamesWhenAnim&&(Array.isArray(o)||(o+=p._classNamesWhenAnim));var s={behaviorTargetList:i,nodeHelper:p.NodeHelper,animationEndEvent:p._animationEndEvent,behavior:o,after:l,eventSystem:t.EventSystem},v=new t.AnimationContext(s);a&&p.Util.isFunction(a)?a(r,v):v.run()};t.EventSystem.addEventListenerHelper(o,r,s,!1),t.EventSystem.registerEventHandle(o,r,s)}}else console.log("You must define some event")},p._eventHelper=function(e){var t="",n=e.event||t;return n===u?n=p._animationEndPrefix():n===f&&(n=p._transitionEndPrefix()),n},p._eventTargetHelper=function(n,r){var i,o=n,a=[o],l=t.rootDOMTravelScope;if(r.eventTarget)if(i=p._eventProviderHelper(r.eventTarget),i.length>0)a=i;else if("document"===r.eventTarget)a=[document];else if("window"===r.eventTarget)a=[e];else if(r.eventTarget.split)try{a=l.querySelectorAll(r.eventTarget)}catch(s){console.log("Ugly Selector Here"),a=[]}return a},p._behaviorTargetHelper=function(e,n,r){var o=e,a=[o],l=t.rootDOMTravelScope,s=n.behaviorTarget;if(s)if(s===d&&r.currentTarget)a=[r.currentTarget];else{s=s.split(i).join(",");try{a=l.querySelectorAll(s)}catch(v){a=[],console.log("ugly selector here")}}return a},p._behaviorHelper=function(e){var t,n=e.behavior||"";return Array.isArray(n)&&(t=p._callbackHelper({},e,n[0]),t?n[0]=t:n=n.join(" ")),n},p._afterHelper=function(e,t){var n=p._callbackHelper(e,t,t.after);return n},p._beforeHelper=function(e,t){var n=p._callbackHelper(e,t,t.before);return n},p._callbackHelper=function(e,t,n){var r=n||"",i=p._helperHelper(t);if(r&&!p.Util.isFunction(r)){var o=p._helperCollection,a=o[i];r=a&&a[r]?a[r]:!1}return r},p._helperHelper=function(e){var t=e.helper||p._helperDefaultIndex;return t},p._eventProviderHelper=function(e){var n=[];if(t.eventProviderCollection,e)if(e.id&&t.EventSystem.isEventTarget(e.value))n.push(e.value),t.registerEventProvider(e);else if(e.split){eventProviderIDList=e.split("$");var r,i=eventProviderIDList.length,o=1;for(o;i>o;o++)if(r=eventProviderIDList[o],r&&" "!==r){r=r.trim();var a=t.getEventProvider(r);a||(a=t.EventSystem.createEventTarget(),t.registerEventProvider({id:r,value:a})),n.push(a)}}return n},p._getParsedAniJSSentenceCollection=function(e){return p.Parser.parse(e)},p._findAniJSNodeCollection=function(e){var t="["+n+"]";return e.querySelectorAll(t)},p._animationEndPrefix=function(){var e=p._endPrefixBrowserDetectionIndex(),t=[u,"oAnimationEnd",u,"webkitAnimationEnd"];return t[e]},p._transitionEndPrefix=function(){var e=p._endPrefixBrowserDetectionIndex(),t=[f,"oTransitionEnd",f,"webkitTransitionEnd"];return t[e]},p._endPrefixBrowserDetectionIndex=function(){for(var e=document.createElement("fakeelement"),t=["animation","OAnimation","MozAnimation","webkitAnimation"],n=0;n<t.length;n++)if(void 0!==e.style[t[n]])return n},t.AnimationContext=function(e){var t=this;t.init=function(e){t.behaviorTargetList=e.behaviorTargetList||[],t.nodeHelper=e.nodeHelper,t.animationEndEvent=e.animationEndEvent,t.behavior=e.behavior,t.after=e.after,t.eventSystem=e.eventSystem},t.doDefaultAction=function(e,n){var r=t,i=r.nodeHelper,o=r.animationEndEvent,a=r.after;i.addClass(e,n),r.eventSystem.addEventListenerHelper(e,o,function(e){e.stopPropagation(),r.eventSystem.removeEventListenerHelper(e.target,e.type,arguments.callee),a?p.Util.isFunction(a)&&a(e,t):i.removeClass(e.target,n)})},t.doFunctionAction=function(e,n){var r=t,i=r.after,o={};n[0](o,t,e,n),p.Util.isFunction(i)&&i(o,t)},t.run=function(){var e=t,n=e.behaviorTargetList,r=n.length,i=e.behavior,o=0;for(t.hasRunned=1,o;r>o;o++)Array.isArray(i)?t.doFunctionAction(n[o],i):t.doDefaultAction(n[o],i)},t.init(e)},p.Parser={parse:function(e){return this.parseDeclaration(e)},parseDeclaration:function(e){var t,n,r=[];t=e.split(";");var i=t.length,o=0;for(o;i>o;o++)n=this.parseSentence(t[o]),r.push(n);return r},parseSentence:function(e){var t,n,r={};t=e.split(",");var i=t.length,o=0;for(o;i>o;o++)n=this.parseDefinition(t[o]),r[n.key]=n.value;return r},parseDefinition:function(e){var t,n,r,i={},v="event",c="eventTarget",u="behavior",f="behaviorTarget";return t=e.split(":"),t.length>1&&(n=t[0].trim(),t.length>2?(r=t.slice(1),r=r.join(":"),r=r.trim()):r=t[1].trim(),i.value=r,n===o?n=v:n===a?n=c:n===l?(n=u,r=this.parseDoDefinition(r)):n===s&&(n=f),i.key=n,i.value=r),i},parseDoDefinition:function(e){var t=e.split("$");return t.length>1&&(t=t[1].split(" "),e=[],e[0]=t[0],e[1]=t.slice(1).join(" ")),e}},p.NodeHelper={addClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;r>n;++n)t[n]&&!new RegExp(v+t[n]+c).test(e.className)&&(e.className=e.className.trim()+" "+t[n])},removeClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;r>n;++n)e.className=e.className.replace(new RegExp(v+t[n]+c)," ").trim()},hasClass:function(e,t){return t&&new RegExp(v+t+c).test(e.className)}},p.Util={isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},t.EventSystem={eventCollection:{},eventIdCounter:0,isEventTarget:function(e){return e.addEventListener?1:0},createEventTarget:function(){return new t.EventTarget},addEventListenerHelper:function(e,t,n){e.addEventListener(t,n,!1)},removeEventListenerHelper:function(e,t,n){e.removeEventListener(t,n)},purgeAll:function(){var e,t,n=this,r=n.eventCollection,i=Object.keys(r),o=i.length,a=0;for(a;o>a;a++)e=i[a],t=r[e],t&&t.handleCollection&&t.handleCollection.length>0&&n.purgeEventTarget(t.handleCollection[0].element),delete r[e]},purgeEventTarget:function(e){var t,n=this,r=e._aniJSEventID;if(r){t=n.eventCollection[r].handleCollection;var i,o=t.length,a=0;for(a;o>a;a++)i=t[a],n.removeEventListenerHelper(e,i.eventType,i.listener);n.eventCollection[r]=e._aniJSEventID=null,delete n.eventCollection[r],delete e._aniJSEventID}},registerEventHandle:function(e,t,n){var r=this,i=e._aniJSEventID,o=r.eventCollection,a={eventType:t,listener:n,element:e};if(i)o[i].handleCollection.push(a);else{var l={handleCollection:[a]};o[++r.eventIdCounter]=l,e._aniJSEventID=r.eventIdCounter}}},t.EventTarget=function(){this._listeners={}},t.EventTarget.prototype={constructor:t.EventTarget,addEventListener:function(e,t){var n=this;"undefined"==typeof n._listeners[e]&&(n._listeners[e]=[]),n._listeners[e].push(t)},dispatchEvent:function(e){var t=this;if("string"==typeof e&&(e={type:e}),e.target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(this._listeners[e.type]instanceof Array)for(var n=t._listeners[e.type],r=0,i=n.length;i>r;r++)n[r].call(t,e)},removeEventListener:function(e,t){var n=this;if(n._listeners[e]instanceof Array)for(var r=n._listeners[e],i=0,o=r.length;o>i;i++)if(r[i]===t){r.splice(i,1);break}}},t}(n||{});return n.init(),n.run(),"function"==typeof define&&define.amd&&define("anijs",[],function(){return n}),"undefined"==typeof t&&(e.AniJS=n),n});