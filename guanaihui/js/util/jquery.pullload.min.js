!function(l){l.fn.pullload=function(e){var a=l.extend({},l.fn.pullload.defaults,e);return this.each(function(){var e=this;l(this).attr("requestable","true"),l(a.handler).on("scroll.pullload",function(){var s=l(window).height(),t=l(window).scrollTop(),o=l(e).children().last(),n=o.height()+o.offset().top+a.threshold;s+t>n&&"true"==l(e).attr("requestable")&&l.fn.pullload.request(e,a)})})},l.fn.pullload.request=function(e,a){l(e).attr("requestable","false");var s=a.crossDomain?"jsonp":"json",t=a.crossDomain?"GET":a.requestType,o={};o[a.requestLoadedKey]=l(e).children().size(),l.fn.pullload.tips(a.loadingTips,e,a);try{l.ajax({url:a.apiUrl,type:t,dataType:s,data:o,success:function(s){return a.callback&&a.callback(s),void 0!==s[a.countKey]&&s[a.countKey]?void(s[a.countKey]<=l(e).children().size()?(l.fn.pullload.tips(a.lastLoadedTips,e,a),l(a.handler).off("scroll.pullload")):(l(e).attr("requestable","true"),l.fn.pullload.closeTips(e,a))):void l.fn.pullload.tips("您的数据接口好像没有给出总条数嘛！",e,a)},error:function(){l.fn.pullload.tips(a.loadFailedTips,e,a)}})}catch(n){l.fn.pullload.tips("错误名称："+n.name+"\n错误描述："+n.message)}},l.fn.pullload.tips=function(e,a,s){0===l(a).next("."+s.tipsClassName).size()&&l(a).after('<div class="'+s.tipsClassName+'"></div>');var t=l(a).next("."+s.tipsClassName);t.html(e),t.slideDown(100)},l.fn.pullload.closeTips=function(e,a){l(e).next("."+a.tipsClassName).slideUp(100)},l.fn.pullload.defaults={handler:window,apiUrl:"",crossDoman:!1,requestType:"GET",callback:null,requestLoadedKey:"loaded",countKey:"count",tipsClassName:"data-status",loadingTips:"数据加载中...",lastLoadedTips:"已经加载到最后一页！",loadFailedTips:"数据加载失败，请重试！",threshold:50}}(jQuery);