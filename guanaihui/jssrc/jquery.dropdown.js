/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 插件名称：dropdown
 2. 插件描述：下拉菜单
 3. 版本：1.0
 4.  对其他插件的依赖：无
 5. 作者：赵华刚(zhaohuagang@guanaihui.com)
 6. 未尽事宜：无
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
(function($) {
    $.fn.dropdown = function(options) {
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        配置属性的扩展
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
        var opts = $.extend({}, $.fn.dropdown.defaults, options);
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
         执行事件添加后返回
         -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
        return this.each(function() {
            var dropdown = this ;
            if(opts.trigger === "click") {
                $(this).click(function(event){                    
                    $.fn.dropdown.pop(dropdown, opts.delay) ;
                    event.stopPropagation() ;
                }) ;
                $(this).find(".dropdown-menu").click(function(event){
                    event.stopPropagation() ;
                }) ;
                $(document).click(function(){
                    $.fn.dropdown.hide(dropdown, opts.delay) ;
                }) ;
            }
            else if(opts.trigger === "hover") {
                $(this).hover(function(){ $.fn.dropdown.pop(dropdown, opts.delay) ; }, function(){ $.fn.dropdown.hide(dropdown, opts.delay) ; }) ;
            }
        });
       
    } ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    下拉菜单的方法
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    $.fn.dropdown.pop = function(dropdown, delay) {
        delay = (typeof delay === "object") ? delay.show : delay ;
        window.setTimeout(function(){            
            $(dropdown).find(".dropdown-menu").css({"visibility" : "visible"}) ;
        }, delay) ;
    }
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    隐藏窗口的方法
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    $.fn.dropdown.hide = function(dropdown, delay) {
        delay = (typeof delay === "object") ? delay.hide : delay ;
        window.setTimeout(function(){
            $(dropdown).find(".dropdown-menu").css({"visibility" : "hidden"}) ;
        }, delay) ;        
    } ;   
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dropdown默认配置
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    $.fn.dropdown.defaults = {        
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        弹出延时，单位为毫秒，默认为0，就是不延时，也可以是对象格式：{"show" : 500 , "hide" : 100 }来表示显示的时候延时和隐藏的时候延时的不同
         -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
        delay : 0 ,       
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        触发下拉菜单的触发事件：click | hover，默认为click
         -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
        trigger : "click"
    } ;
})(jQuery) ;